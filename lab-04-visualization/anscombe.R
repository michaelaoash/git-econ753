## pdf(file="anscombe.pdf", paper="USr", height=0, width=0)

library(tidyverse)

anscombe

anscombe_tidy <- anscombe %>%
    mutate(observation = seq_len(n())) %>%
    gather(key, value, -observation) %>%
    separate(key, c("variable", "set"),sep=1, convert = TRUE) %>%
    mutate(set = c("I", "II", "III", "IV")[set]) %>%
    spread(variable, value) %>% arrange(set,observation)

anscombe_tidy

summarize(group_by(anscombe_tidy,set),
          mean(x), sd(x), mean(y), sd(y), cor(x,y),
          alpha=coef(lm(y ~ x))[1], beta=coef(lm(y ~ x))[2], R2=summary(lm(y ~ x))$r.squared 
          )

ggplot(data=anscombe_tidy, aes(x=x, y=y, color=set)) +
    geom_point() +
    facet_wrap(vars(set)) +
    geom_smooth(method = "lm", se = TRUE)


ggplot(data=anscombe_tidy, aes(x=x, y=y, color=set)) +
    geom_point() +
    facet_wrap(vars(set)) 


ggplot(anscombe_tidy, aes(x=x, y=y, color=observation, size=set)) +
    geom_point() +
    facet_wrap (~ set)

ggplot(anscombe, aes(x=x1, y=y1)) + geom_point(color="blue") +
    geom_point(aes(x=x2,y=y2), color="red") +
    geom_point(aes(x=x3,y=y3), color="green") 

anscombe_tidy %>% ggplot(aes(x=x,y=y,color=set)) + geom_point()


plot(anscombe$x1, anscombe$y1)
